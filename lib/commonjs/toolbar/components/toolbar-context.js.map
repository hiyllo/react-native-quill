{"version":3,"sources":["toolbar-context.tsx"],"names":["ToolbarContext","React","createContext","apply","show","hide","selectedFormats","open","isSelected","theme","lightTheme","options","selectionName","getSelected","ToolbarConsumer","Consumer","ToolbarProvider","Component","constructor","props","name","state","isAnimating","setState","Animated","timing","animatedValue","toValue","size","duration","easing","Easing","sin","useNativeDriver","start","linear","value","selected","format","custom","actions","find","x","indexOf","handler","Value","componentDidMount","render","children","styles","defaultStyles","makeStyles","rootStyle","toolbar","provider","root","height","StyleSheet","create","borderTopWidth","borderLeftWidth","borderRightWidth","borderColor","color","position","backgroundColor","background","width","withToolbar","MyComponent","WrappedComponent","forwardRef","ref","context","useToolbar"],"mappings":"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","sourcesContent":["import React, { Component, useContext } from 'react';\nimport { StyleSheet, Animated, Easing } from 'react-native';\nimport { lightTheme } from '../../constants/themes';\nimport type {\n  CustomStyles,\n  ToggleData,\n  ToolbarCustom,\n  ToolbarTheme,\n} from '../../types';\n\nexport interface ContextProps {\n  apply: (name: string, value: any) => void;\n  selectedFormats: object;\n  isSelected: (name: string, value: any) => boolean;\n  theme: ToolbarTheme;\n  show: (name: string, options: Array<ToggleData>) => void;\n  hide: Function;\n  open: boolean;\n  options: Array<ToggleData>;\n  selectionName: string;\n  getSelected: (name: string) => any;\n  styles?: CustomStyles;\n}\n\nconst ToolbarContext = React.createContext<ContextProps>({\n  apply: () => {},\n  show: () => {},\n  hide: () => {},\n  selectedFormats: {},\n  open: false,\n  isSelected: () => false,\n  theme: lightTheme,\n  options: [],\n  selectionName: '',\n  getSelected: () => false,\n});\n\nexport const ToolbarConsumer = ToolbarContext.Consumer;\n\ninterface ProviderProps {\n  format: Function;\n  selectedFormats: Record<string, any>;\n  theme: ToolbarTheme;\n  custom?: ToolbarCustom;\n  styles?: CustomStyles;\n}\n\ninterface ProviderState {\n  open: boolean;\n  isAnimating: boolean;\n  options: Array<ToggleData>;\n  name: string;\n}\n\nexport class ToolbarProvider extends Component<ProviderProps, ProviderState> {\n  animatedValue: Animated.Value;\n  constructor(props: ProviderProps) {\n    super(props);\n    this.state = {\n      open: false,\n      isAnimating: false,\n      options: [],\n      name: '',\n    };\n    this.animatedValue = new Animated.Value(0);\n  }\n\n  show = (name: string, options: Array<ToggleData>) => {\n    if (this.state.isAnimating) return;\n\n    const { theme } = this.props;\n    if (theme) {\n      this.setState({ options, name, isAnimating: true }, () => {\n        Animated.timing(this.animatedValue, {\n          toValue: 2 * theme.size + 14,\n          duration: 200,\n          easing: Easing.sin,\n          useNativeDriver: false,\n        }).start(() => this.setState({ open: true, isAnimating: false }));\n      });\n    }\n  };\n\n  hide = () => {\n    if (this.state.isAnimating) return;\n    const { theme } = this.props;\n    if (theme) {\n      this.setState({ isAnimating: true }, () => {\n        Animated.timing(this.animatedValue, {\n          toValue: theme.size + 10,\n          duration: 200,\n          easing: Easing.linear,\n          useNativeDriver: false,\n        }).start(() => {\n          this.setState({\n            name: '',\n            open: false,\n            options: [],\n            isAnimating: false,\n          });\n        });\n      });\n    }\n  };\n\n  componentDidMount() {\n    const { theme } = this.props;\n    this.animatedValue = new Animated.Value(theme.size + 10);\n  }\n\n  isSelected = (name: string, value: any = true): boolean => {\n    const { selectedFormats } = this.props;\n    const selected = selectedFormats[name];\n    return selected ? selected === value : value === false;\n  };\n\n  getSelected = (name: string): any => {\n    const { selectedFormats } = this.props;\n    const selected = selectedFormats[name];\n    return selected ? selected : false;\n  };\n\n  apply = (name: string, value: any) => {\n    const { format, custom } = this.props;\n\n    if (custom?.actions) custom.actions.find((x) => x === name);\n    if (custom?.actions && custom?.actions?.indexOf(name) > -1) {\n      if (custom?.handler) custom.handler(name, value);\n    } else {\n      format(name, value);\n    }\n  };\n\n  render() {\n    const { selectedFormats, children, theme, styles } = this.props;\n    const { open, options, name } = this.state;\n    const defaultStyles = makeStyles(theme);\n    const rootStyle = styles?.toolbar?.provider\n      ? styles?.toolbar?.provider(defaultStyles.root)\n      : defaultStyles.root;\n    return (\n      <ToolbarContext.Provider\n        value={{\n          selectedFormats,\n          apply: this.apply,\n          isSelected: this.isSelected,\n          theme,\n          open,\n          show: this.show,\n          hide: this.hide,\n          getSelected: this.getSelected,\n          selectionName: name,\n          options,\n          styles,\n        }}\n      >\n        <Animated.View\n          style={[\n            rootStyle,\n            {\n              height: this.animatedValue,\n            },\n          ]}\n        >\n          {children}\n        </Animated.View>\n      </ToolbarContext.Provider>\n    );\n  }\n}\n\nconst makeStyles = (theme: ToolbarTheme) =>\n  StyleSheet.create({\n    root: {\n      borderTopWidth: 1,\n      borderLeftWidth: 1,\n      borderRightWidth: 1,\n      borderColor: theme.color,\n      position: 'relative',\n      backgroundColor: theme.background,\n      width: '100%',\n    },\n  });\n\nexport const withToolbar = (MyComponent: any) => {\n  const WrappedComponent = React.forwardRef((props, ref) => (\n    <ToolbarContext.Consumer>\n      {(context) => (\n        <MyComponent\n          {...props}\n          ref={ref}\n          apply={context.apply}\n          selectedFormats={context.selectedFormats}\n        />\n      )}\n    </ToolbarContext.Consumer>\n  ));\n\n  return WrappedComponent;\n};\n\nexport const useToolbar = (): ContextProps => useContext(ToolbarContext);\n"]}