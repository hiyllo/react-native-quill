{"version":3,"sources":["quill-editor.tsx"],"names":["QuillEditor","React","Component","constructor","props","initialHtml","import3rdParties","containerId","theme","background","color","placeholder","quill","id","modules","toolbar","customFonts","customStyles","defaultFontFamily","undefined","customJS","autoSize","JSON","stringify","clipboard","keyboard","libraries","editorId","fonts","backgroundColor","placeholderColor","obj","jsonString","_webview","current","postMessage","data","message","parse","event","toMessage","nativeEvent","response","key","_promises","find","x","type","setState","height","_handlers","filter","forEach","item","handler","resolve","webview","onMessage","post","command","Platform","OS","requestFocus","postAwait","enable","value","name","index","length","focus","source","text","formats","delta","push","findIndex","splice","html","content","style","syntheticEvent","console","warn","createRef","state","webviewContent","getInitalHtml","onSelectionChange","onEditorChange","onTextChange","onHtmlChange","onDimensionsChange","onBlur","onFocus","on","getKey","timestamp","Date","getUTCMilliseconds","Math","random","resolveFn","promise","Promise","resp","render","container","loading","renderWebview","ContainerComponent","View","styles","webView","StyleSheet","create","flexGrow","borderWidth"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  WebView,\n  WebViewMessageEvent,\n  WebViewProps,\n} from 'react-native-webview';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  StyleProp,\n  ViewStyle,\n  Platform,\n} from 'react-native';\nimport { createHtml } from '../utils/editor-utils';\nimport type {\n  CustomFont,\n  EditorMessage,\n  EditorResponse,\n  GetLeafResponse,\n  QuillConfig,\n} from '../types';\nimport type {\n  EditorEventHandler,\n  EditorEventType,\n  SelectionChangeData,\n  EditorChangeData,\n  TextChangeData,\n  HtmlChangeData,\n  DimensionsChangeData,\n  Range,\n} from '../constants/editor-event';\nimport { Loading } from './loading';\n\nexport interface EditorState {\n  webviewContent: string | null;\n  height?: number;\n}\n\nexport interface EditorProps {\n  autoSize?: boolean;\n  style?: StyleProp<ViewStyle>;\n  quill?: QuillConfig;\n  customFonts?: Array<CustomFont>;\n  defaultFontFamily?: string;\n  initialHtml?: string;\n  customStyles?: string[];\n  import3rdParties?: 'local' | 'cdn';\n  containerId?: string;\n  theme?: { background: string; color: string; placeholder: string };\n  loading?: string | React.ReactNode;\n  container?: boolean | React.ComponentType;\n  onSelectionChange?: (data: SelectionChangeData) => void;\n  onTextChange?: (data: TextChangeData) => void;\n  onHtmlChange?: (data: HtmlChangeData) => void;\n  onEditorChange?: (data: EditorChangeData) => void;\n  onDimensionsChange?: (data: DimensionsChangeData) => void;\n  webview?: WebViewProps;\n  onBlur?: () => void;\n  onFocus?: () => void;\n  customJS?: string;\n}\n\nexport default class QuillEditor extends React.Component<\n  EditorProps,\n  EditorState\n> {\n  private _webview: React.RefObject<WebView>;\n  private _handlers: Array<{\n    event: EditorEventType;\n    handler: EditorEventHandler;\n  }>;\n  private _promises: Array<EditorResponse>;\n\n  constructor(props: EditorProps) {\n    super(props);\n    this._webview = React.createRef();\n    this.state = {\n      webviewContent: this.getInitalHtml(),\n    };\n\n    this._handlers = [];\n    this._promises = [];\n    const {\n      onSelectionChange,\n      onEditorChange,\n      onTextChange,\n      onHtmlChange,\n      onDimensionsChange,\n      onBlur,\n      onFocus,\n    } = this.props;\n    if (onSelectionChange) {\n      this.on('selection-change', onSelectionChange);\n    }\n    if (onEditorChange) {\n      this.on('editor-change', onEditorChange);\n    }\n    if (onTextChange) {\n      this.on('text-change', onTextChange);\n    }\n    if (onHtmlChange) {\n      this.on('html-change', onHtmlChange);\n    }\n    if (onDimensionsChange) {\n      this.on('dimensions-change', onDimensionsChange);\n    }\n    if (onBlur) {\n      this.on('blur', onBlur);\n    }\n    if (onFocus) {\n      this.on('focus', onFocus);\n    }\n  }\n\n  private getInitalHtml = (): string => {\n    const {\n      initialHtml = '',\n      import3rdParties = 'local',\n      containerId = 'standalone-container',\n      theme = {\n        background: 'white',\n        color: 'rgb(32, 35, 42)',\n        placeholder: 'rgba(0,0,0,0.6)',\n      },\n      quill = {\n        id: 'editor-container',\n        placeholder: 'write here!',\n        modules: {\n          toolbar: false,\n        },\n        theme: 'snow',\n      },\n      customFonts = [],\n      customStyles = [],\n      defaultFontFamily = undefined,\n      customJS = '',\n    } = this.props;\n\n    return createHtml({\n      initialHtml,\n      autoSize: this.props.autoSize,\n      placeholder: quill.placeholder,\n      theme: quill.theme ? quill.theme : 'snow',\n      toolbar: JSON.stringify(quill.modules?.toolbar),\n      clipboard: quill.modules?.clipboard,\n      keyboard: quill.modules?.keyboard,\n      libraries: import3rdParties,\n      editorId: quill.id ? quill.id : 'editor-container',\n      defaultFontFamily,\n      containerId,\n      color: theme.color,\n      fonts: customFonts,\n      backgroundColor: theme.background,\n      placeholderColor: theme.placeholder,\n      customStyles,\n      customJS,\n    });\n  };\n\n  private getKey(): string {\n    var timestamp = new Date().getUTCMilliseconds();\n    return `${timestamp}${Math.random()}`;\n  }\n\n  private postAwait<T>(data: any): Promise<T> {\n    const key = this.getKey();\n    let resolveFn: (value: T | PromiseLike<T>) => void;\n    resolveFn = () => {};\n    const promise = new Promise<T>((resolve) => {\n      resolveFn = resolve;\n    });\n\n    const resp: EditorResponse = {\n      key,\n      resolve: resolveFn,\n    };\n\n    this._promises.push(resp);\n    this.post({ ...data, key });\n\n    return promise;\n  }\n\n  private post = (obj: object) => {\n    const jsonString = JSON.stringify(obj);\n    this._webview.current?.postMessage(jsonString);\n  };\n\n  private toMessage = (data: string): EditorMessage => {\n    const message: EditorMessage = JSON.parse(data);\n    return message;\n  };\n\n  private onMessage = (event: WebViewMessageEvent) => {\n    const message = this.toMessage(event.nativeEvent.data);\n    const { autoSize } = this.props;\n    const response = message.key\n      ? this._promises.find((x) => x.key === message.key)\n      : undefined;\n    switch (message.type) {\n      case 'dimensions-change':\n        if (autoSize === true) this.setState({ height: message.data.height });\n        this._handlers\n          .filter((x) => x.event === message.type)\n          .forEach((item) => item.handler(message.data));\n        break;\n      case 'format-change':\n      case 'text-change':\n      case 'selection-change':\n      case 'html-change':\n      case 'editor-change':\n      case 'blur':\n      case 'focus':\n        this._handlers\n          .filter((x) => x.event === message.type)\n          .forEach((item) => item.handler(message.data));\n        break;\n      case 'has-focus':\n      case 'get-contents':\n      case 'set-contents':\n      case 'get-text':\n      case 'get-length':\n      case 'get-bounds':\n      case 'get-selection':\n      case 'get-dimensions':\n      case 'get-html':\n      case 'get-format':\n      case 'get-leaf':\n      case 'remove-format':\n      case 'format-text':\n        if (response) {\n          response.resolve(message.data);\n          this._promises = this._promises.filter((x) => x.key !== message.key);\n        }\n        break;\n      default:\n        // Allow catching messages using the passed webview props\n        if (this.props.webview?.onMessage) {\n          this.props.webview?.onMessage(event);\n        }\n    }\n  };\n\n  blur = () => {\n    this.post({ command: 'blur' });\n  };\n\n  focus = () => {\n    this.post({ command: 'focus' });\n\n    if (Platform.OS === 'android') {\n      this._webview.current?.requestFocus();\n    }\n  };\n\n  hasFocus = (): Promise<boolean> => {\n    return this.postAwait<any>({ command: 'hasFocus' });\n  };\n\n  enable = (enable = true) => {\n    this.post({ command: 'enable', value: enable });\n  };\n\n  disable = () => {\n    this.post({ command: 'enable', value: false });\n  };\n\n  update = () => {\n    this.post({ command: 'update' });\n  };\n\n  format = (name: string, value: any) => {\n    this.post({ command: 'format', name, value });\n  };\n\n  deleteText = (index: number, length: number) => {\n    this.post({ command: 'deleteText', index, length });\n  };\n\n  removeFormat = (index: number, length: number) => {\n    return this.postAwait({ command: 'removeFormat', index, length });\n  };\n\n  getDimensions = (): Promise<any> => {\n    return this.postAwait<any>({ command: 'getDimensions' });\n  };\n\n  getContents = (index?: number, length?: number): Promise<any> => {\n    return this.postAwait<any>({ command: 'getContents', index, length });\n  };\n\n  getHtml = (): Promise<string> => {\n    return this.postAwait<any>({ command: 'getHtml' });\n  };\n\n  getLength = (): Promise<number> => {\n    return this.postAwait<any>({ command: 'getLength' });\n  };\n\n  getText = (index?: number, length?: number): Promise<string> => {\n    return this.postAwait<any>({ command: 'getText', index, length });\n  };\n\n  getBounds = (\n    index: number,\n    length?: number\n  ): Promise<{ left: number; top: number; height: number; width: number }> => {\n    return this.postAwait<any>({ command: 'getBounds', index, length });\n  };\n\n  getSelection = (focus: boolean = false): Promise<Range> => {\n    return this.postAwait<any>({ command: 'getSelection', focus });\n  };\n\n  setSelection = (index: number, length?: number, source?: String) => {\n    this.post({ command: 'setSelection', index, length, source });\n  };\n\n  insertEmbed = (index: number, type: string, value: any) => {\n    this.post({ command: 'insertEmbed', index, type, value });\n  };\n\n  insertText = (index: number, text: string, formats?: Record<string, any>) => {\n    this.post({ command: 'insertText', index, text, formats });\n  };\n\n  setContents = (delta: any): Promise<any> => {\n    return this.postAwait<any>({ command: 'setContents', delta });\n  };\n\n  setText = (text: string) => {\n    this.post({ command: 'setText', text });\n  };\n\n  setPlaceholder = (text: string) => {\n    this.post({ command: 'setPlaceholder', text });\n  };\n\n  updateContents = (delta: any) => {\n    this.post({ command: 'updateContents', delta });\n  };\n\n  getFormat = (\n    index: { index: number; length: number } | number,\n    length?: number\n  ): Promise<Record<string, unknown>> => {\n    return this.postAwait({ command: 'getFormat', index, length });\n  };\n\n  getLeaf = (index: number): Promise<GetLeafResponse | null> => {\n    return this.postAwait({ command: 'getLeaf', index });\n  };\n\n  formatText = (\n    index: number,\n    length: number,\n    formats: Record<string, unknown>,\n    source: string = 'api'\n  ): Promise<any> => {\n    return this.postAwait({\n      command: 'formatText',\n      index,\n      length,\n      formats,\n      source,\n    });\n  };\n\n  on = (event: EditorEventType, handler: EditorEventHandler) => {\n    this._handlers.push({ event, handler });\n  };\n\n  off = (event: EditorEventType, handler: Function) => {\n    const index = this._handlers.findIndex(\n      (x) => x.event === event && x.handler === handler\n    );\n    if (index > -1) {\n      this._handlers.splice(index, 1);\n    }\n  };\n\n  dangerouslyPasteHTML = (index: number, html: string) => {\n    this.post({ command: 'dangerouslyPasteHTML', index, html });\n  };\n\n  renderWebview = (\n    content: string,\n    style: StyleProp<ViewStyle>,\n    props: WebViewProps = {}\n  ) => (\n    <WebView\n      scrollEnabled={false}\n      nestedScrollEnabled={true}\n      hideKeyboardAccessoryView={true}\n      keyboardDisplayRequiresUserAction={false}\n      originWhitelist={['*']}\n      style={style}\n      onError={(syntheticEvent) => {\n        const { nativeEvent } = syntheticEvent;\n        console.warn('WebView error: ', nativeEvent);\n      }}\n      allowFileAccess={true}\n      domStorageEnabled={false}\n      automaticallyAdjustContentInsets={true}\n      bounces={false}\n      dataDetectorTypes=\"none\"\n      {...props}\n      javaScriptEnabled={true}\n      source={{ html: content }}\n      ref={this._webview}\n      onMessage={this.onMessage}\n    />\n  );\n\n  render() {\n    const { webviewContent, height } = this.state;\n    const {\n      style,\n      webview,\n      container = false,\n      loading = 'Please Wait ...',\n      autoSize = false,\n    } = this.props;\n    if (container === false) {\n      if (!webviewContent) return <Text>Please wait...</Text>;\n      return this.renderWebview(webviewContent, style, webview);\n    } else {\n      const ContainerComponent = container === true ? View : container;\n      return (\n        <ContainerComponent\n          style={[style, autoSize && height ? { height } : {}]}\n        >\n          {webviewContent ? (\n            this.renderWebview(webviewContent, styles.webView, webview)\n          ) : typeof loading === 'string' ? (\n            <Loading text={loading} />\n          ) : (\n            loading\n          )}\n        </ContainerComponent>\n      );\n    }\n  }\n}\n\nlet styles = StyleSheet.create({\n  webView: {\n    flexGrow: 1,\n    borderWidth: 0,\n  },\n});\n"]}